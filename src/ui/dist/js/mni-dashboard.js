let ready=null,retryMs=5e3,refreshMs=3e5,chartResource=null,totalCable=0,activeCable=0,inactiveCable=0,totalDuct=0,activeDuct=0,inactiveDuct=0,totalPole=0,activePole=0,inactivePole=0,totalNE=0,activeNE=0,inactiveNE=0,totalSite=0,activeSite=0,inactiveSite=0,totalService=0,activeService=0,inactiveService=0,totalTrench=0,activeTrench=0,inactiveTrench=0,activeRack=0,inactiveRack=0,dbmReady=null,totalPremisesPassed=0,totalTrenchDistance=0,totalTrenchDistanceUnit="",costCable=0,costDuct=0,costPole=0,costNe=0,costRack=0,costService=0,costSite=0,costTrench=0,costTotal=0;function toPercent(e,t){let a=0;try{return t>0&&(a=Number.parseFloat(e/t*100).toFixed(0)),a}catch(e){return 0}}function toInteger(e){return Number.isNaN(Number.parseInt(e,10))?0:Number.parseInt(e,10)}function toDecimal(e,t=2){return Number.isNaN(Number.parseFloat(e))?Number(0):Number(parseFloat(e).toFixed(t))}function fetchStats(){null!=ready&&clearTimeout(ready),fetch(localStorage.getItem("mni.gatewayUrl")+"/ui/statistic",{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();ready=setTimeout(fetchStats,refreshMs,e.status)})).then((e=>{if(null!=e.resources&&(null!=e.resources?.cables&&(null!=e.resources?.cables?.total&&(totalCable=toInteger(e.resources.cables.total)),null!=e.resources?.cables?.active&&(activeCable=toInteger(e.resources.cables.active)),null!=e.resources?.cables?.inactive&&(inactiveCable=toInteger(e.resources.cables.inactive))),null!=e.resources?.ducts&&(null!=e.resources?.ducts?.total&&(totalDuct=toInteger(e.resources.ducts.total)),null!=e.resources?.ducts?.active&&(activeDuct=toInteger(e.resources.ducts.active)),null!=e.resources?.ducts?.inactive&&(inactiveDuct=toInteger(e.resources.ducts.inactive))),null!=e.resources?.poles&&(null!=e.resources?.poles?.total&&(totalPole=toInteger(e.resources.poles.total)),null!=e.resources?.poles?.active&&(activePole=toInteger(e.resources.poles.active)),null!=e.resources?.poles?.inactive&&(inactivePole=toInteger(e.resources.poles.inactive))),null!=e.resources?.nes&&(null!=e.resources?.nes?.total&&(totalNE=toInteger(e.resources.nes.total)),null!=e.resources?.nes?.active&&(activeNE=toInteger(e.resources.nes.active)),null!=e.resources?.nes?.inactive&&(inactiveNE=toInteger(e.resources.nes.inactive))),null!=e.resources?.racks&&(null!=e.resources?.racks?.total&&(totalRack=toInteger(e.resources.racks.total)),null!=e.resources?.racks?.active&&(activeRack=toInteger(e.resources.racks.active)),null!=e.resources?.racks?.inactive&&(inactiveRack=toInteger(e.resources.racks.inactive))),null!=e.resources?.services&&(null!=e.resources?.services?.total&&(totalService=toInteger(e.resources.services.total)),null!=e.resources?.services?.active&&(activeService=toInteger(e.resources.services.active)),null!=e.resources?.services?.inactive&&(inactiveService=toInteger(e.resources.services.inactive))),null!=e.resources?.sites&&(null!=e.resources?.sites?.total&&(totalSite=toInteger(e.resources.sites.total)),null!=e.resources?.sites?.active&&(activeSite=toInteger(e.resources.sites.active)),null!=e.resources?.sites?.inactive&&(inactiveSite=toInteger(e.resources.sites.inactive))),null!=e.resources?.trenches&&(null!=e.resources?.trenches?.total&&(totalTrench=toInteger(e.resources.trenches.total)),null!=e.resources?.trenches?.active&&(activeTrench=toInteger(e.resources.trenches.active)),null!=e.resources?.trenches?.inactive&&(inactiveTrench=toInteger(e.resources.trenches.inactive)),null!=e.metrics&&(document.getElementById("businessMetricsPanel").innerHTML="<center>Premises Passed: "+e.metrics.premises.passed+"&emsp;|&emsp;Trench Coverage: "+e.metrics.trench.distance+e.metrics.trench.unit+"&emsp;|&emsp;Cable Coverage: "+e.metrics.cable.distance+e.metrics.cable.unit+"</center>"),null!=e.metrics.cost))){let t="Euro",a="EUR",c="â‚¬";document.getElementById("businessCostsPanel").innerHTML="Costs: ("+t+") &emsp;Cables "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.cable)+"&emsp;|&emsp;Ducts "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.duct)+"&emsp;|&emsp;Poles "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.pole)+"&emsp;|&emsp;NE "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.ne)+"&emsp;|&emsp;Racks "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.rack)+"&emsp;|&emsp;Services "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.service)+"&emsp;|&emsp;Sites "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.site)+"&emsp;|&emsp;Trenches "+c+new Intl.NumberFormat({style:"currency",currency:a,symbol:c}).format(e.metrics.cost.trench)}activeCable=toPercent(activeCable,totalCable),inactiveCable=toPercent(inactiveCable,totalCable),activeDuct=toPercent(activeDuct,totalDuct),inactiveDuct=toPercent(inactiveDuct,totalDuct),activePole=toPercent(activePole,totalPole),inactivePole=toPercent(inactivePole,totalPole),activeNE=toPercent(activeNE,totalNE),inactiveNE=toPercent(inactiveNE,totalNE),activeService=toPercent(activeService,totalService),inactiveService=toPercent(inactiveService,totalService),activeSite=toPercent(activeSite,totalSite),inactiveSite=toPercent(inactiveSite,totalSite),activeTrench=toPercent(activeTrench,totalTrench),inactiveTrench=toPercent(inactiveTrench,totalTrench),activeRack=toPercent(activeRack,totalRack),inactiveRack=toPercent(inactiveRack,totalRack),Chart.defaults.font.family="Lato",null!=chartResource?(chartResource.data.labels[0]="Cables: "+totalCable.toString(),chartResource.data.labels[1]="Ducts: "+totalDuct.toString(),chartResource.data.labels[2]="NE: "+totalNE.toString(),chartResource.data.labels[3]="Poles: "+totalPole.toString(),chartResource.data.labels[4]="Racks: "+totalSite.toString(),chartResource.data.labels[5]="Sites: "+totalSite.toString(),chartResource.data.labels[6]="Services: "+totalService.toString(),chartResource.data.labels[7]="Trenches: "+totalTrench.toString(),chartResource.data.datasets[0].data[0]=activeCable,chartResource.data.datasets[0].data[1]=activeDuct,chartResource.data.datasets[0].data[2]=activeNE,chartResource.data.datasets[0].data[3]=activePole,chartResource.data.datasets[0].data[4]=activeRack,chartResource.data.datasets[0].data[5]=activeSite,chartResource.data.datasets[0].data[6]=activeService,chartResource.data.datasets[0].data[7]=activeTrench,chartResource.data.datasets[1].data[0]=inactiveCable,chartResource.data.datasets[1].data[1]=inactiveDuct,chartResource.data.datasets[1].data[2]=inactiveNE,chartResource.data.datasets[1].data[3]=inactivePole,chartResource.data.datasets[1].data[4]=inactiveRack,chartResource.data.datasets[1].data[5]=inactiveSite,chartResource.data.datasets[1].data[6]=inactiveService,chartResource.data.datasets[1].data[7]=inactiveTrench,chartResource.update()):chartResource=new Chart("resourceSummary",{type:"bar",options:{indexAxis:"y",responsive:!0,scales:{x:{display:!1,stacked:!0,grid:{display:!1},scales:{x:{display:!1}}},y:{stacked:!0,grid:{display:!1}}},plugins:{legend:{display:!1}}},data:{labels:["Cables: "+totalCable.toString(),"Ducts: "+totalDuct.toString(),"NE: "+totalNE.toString(),"Racks: "+totalRack.toString(),"Poles: "+totalPole.toString(),"Sites: "+totalSite.toString(),"Services: "+totalService.toString(),"Trenches: "+totalTrench.toString()],datasets:[{data:[activeCable,activeDuct,activeNE,activePole,activeRack,activeSite,activeService,activeTrench],backgroundColor:"rgba(0,128,0,1)",hoverBackgroundColor:"rgba(10,99,10,1)"},{data:[inactiveCable,inactiveDuct,inactiveNE,inactivePole,inactiveRack,inactiveSite,inactiveService,inactiveTrench],backgroundColor:"rgba(255,165,0,1)",hoverBackgroundColor:"rgba(255,106,0,1)"}]}}),ready=setTimeout(fetchStats,refreshMs)})).catch((e=>{console.error(e)}))}try{fetchStats()}catch(e){console.error(e)}