let retryMs=1e3,refreshMs=3e5,fpReady=null,dpReady=null,spReady=null,fplReady=null;function firstProvider(){let e=document.getElementById("provider");e.selectedIndex,e.length>1&&(e.selectedIndex=1,fetchProvider(),document.getElementById("meter").setAttribute("value",1))}function previousProvider(){let e=document.getElementById("provider"),t=e.selectedIndex;e.length,t>=2&&(e.selectedIndex=t-1,fetchProvider(),document.getElementById("meter").setAttribute("value",t-1))}function nextProvider(){let e=document.getElementById("provider"),t=e.selectedIndex;t<e.length-1&&(e.selectedIndex=t+1,fetchProvider(),document.getElementById("meter").setAttribute("value",t+1))}function lastProvider(){let e=document.getElementById("provider"),t=e.selectedIndex,r=e.length-1;t<r&&r>1&&(e.selectedIndex=r,fetchProvider(),document.getElementById("meter").setAttribute("value",r))}function deleteProvider(){let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;null!=t&&"-1"!=t&&fetch(localStorage.getItem("mni.gatewayUrl")+"/admin/kafka/broker/"+t,{method:"DELETE",keepalive:!0}).then((e=>{e.ok?(previousProvider(),fetchProviderList()):window.alert(`Failed to delete provider ${t}`)})).catch((e=>{}))}function redisplayProvider(){let e=document.getElementById("provider");"-1"==e.options[e.selectedIndex].value?clearProvider():fetchProvider()}function newProvider(){document.getElementById("provider").value="-1",clearProvider()}function saveProvider(){let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;if(document.getElementById("brokerName").value.length>0)if(document.getElementById("clientId").value.length>0)if(document.getElementById("producerHost").value.length>0)if(document.getElementById("producerPort").value.length>0){let e=document.getElementById("producerAuthenticationMethod");if("-1"!=e.options[e.selectedIndex].value){let e=document.getElementById("producerAuthenticationMethod");if("-1"!=e.options[e.selectedIndex].value)if("-1"==t){let e={name:document.getElementById("brokerName").value,clientId:document.getElementById("clientId").value,producer:{username:document.getElementById("producerUsername").value,password:document.getElementById("producerPassword").value,host:document.getElementById("producerHost").value,port:toInteger(document.getElementById("producerPort").value),retryDelay:toInteger(document.getElementById("producerRetryDelay").value),retries:toInteger(document.getElementById("producerRetries").value),acks:document.getElementById("producerAcks").value,linger:toInteger(document.getElementById("producerLinger").value),batchSize:toInteger(document.getElementById("producerBatchSize").value),bufferMemory:toInteger(document.getElementById("producerBufferMemory").value),maxInFlightRequestsPerConnection:toInteger(document.getElementById("producerMaxInflightRequestsPerConnection").value),compressionMethod:document.getElementById("producerCompressionMethod").value,authentication:document.getElementById("producerAuthenticationMethod").value}};fetch(localStorage.getItem("mni.gatewayUrl")+"/admin/kafka/broker",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),keepalive:!0}).then((e=>{e.ok&&(fetchProviderList(),lastProvider())})).catch((e=>{window.alert(e)}))}else{let e={kafkaProducerId:t,name:document.getElementById("brokerName").value,clientId:document.getElementById("clientId").value,producer:{username:document.getElementById("producerUsername").value,password:document.getElementById("producerPassword").value,host:document.getElementById("producerHost").value,port:toInteger(document.getElementById("producerPort").value),retryDelay:toInteger(document.getElementById("producerRetryDelay").value),retries:toInteger(document.getElementById("producerRetries").value),acks:document.getElementById("producerAcks").value,linger:toInteger(document.getElementById("producerLinger").value),batchSize:toInteger(document.getElementById("producerBatchSize").value),bufferMemory:toInteger(document.getElementById("producerBufferMemory").value),maxInFlightRequestsPerConnection:toInteger(document.getElementById("producerMaxInflightRequestsPerConnection").value),compressionMethod:document.getElementById("producerCompressionMethod").value,authentication:document.getElementById("producerAuthenticationMethod").value}};fetch(localStorage.getItem("mni.gatewayUrl")+"/admin/kafka/broker/"+t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then((e=>{e.ok||window.alert(`Failed to update provider ${t}`)})).catch((e=>{window.alert(e)}))}else window.alert("authentication method must be specified")}else window.alert("compression method must be specified")}else window.alert("port must be specified");else window.alert("host must be specified");else window.alert("client identifier must be specified")}function clearProvider(){document.getElementById("brokerName").value="",document.getElementById("clientId").value="mni",document.getElementById("producerUsername").value="",document.getElementById("producerPassword").value="",document.getElementById("producerHost").value="",document.getElementById("producerPort").value="9092",document.getElementById("producerRetryDelay").value="10000",document.getElementById("producerRetries").value="2",document.getElementById("producerAcks").value="leader",document.getElementById("producerLinger").value="0",document.getElementById("producerBufferMemory").value="16",document.getElementById("producerMaxInflightRequestsPerConnection").value="5",document.getElementById("producerCompressionMethod").value="-1",document.getElementById("producerAuthenticationMethod").value="-1"}function displayProvider(e){clearProvider();let t=document.getElementById("provider");t.options[t.selectedIndex].value,void 0!==e&&null!=e&&(document.getElementById("brokerName").value=e.name,document.getElementById("clientId").value=e.clientId,document.getElementById("producerUsername").value=e.producer.username,document.getElementById("producerUsername").value=e.producer.username,document.getElementById("producerPassword").value=e.producer.password,document.getElementById("producerHost").value=e.producer.host,document.getElementById("producerPort").value=toInteger(e.producer.port),document.getElementById("producerRetryDelay").value=toInteger(e.producer.retryDelay),document.getElementById("producerRetries").value=toInteger(e.producer.retries),document.getElementById("producerAcks").value=e.producer.acks,document.getElementById("producerLinger").value=toInteger(e.producer.linger),document.getElementById("producerBufferMemory").value=toInteger(e.producer.bufferMemory),document.getElementById("producerMaxInflightRequestsPerConnection").value=toInteger(e.producer.maxInFlightRequestsPerConnection),document.getElementById("producerCompressionMethod").value=e.producer.compressionMethod,document.getElementById("producerAuthenticationMethod").value=e.producer.authentication)}function fetchProvider(){null!=fpReady&&clearTimeout(fpReady);let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;null!=t?fetch(localStorage.getItem("mni.gatewayUrl")+"/admin/kafka/broker/"+t,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();fpReady=setTimeout(fetchProvider,retryMs)})).then((e=>{displayProvider(e)})).catch((e=>{fpReady=setTimeout(fetchProvider,retryMs)})):fpReady=setTimeout(fetchProvider,retryMs)}function fetchProviderList(){null!=fplReady&&clearTimeout(fplReady),fetch(localStorage.getItem("mni.gatewayUrl")+"/admin/kafka/broker",{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();fplReady=setTimeout(fetchProviderList,retryMs)})).then((e=>{let t="<option disabled value='-1' selected='selected'> -- new provider -- </option>";for(var r=0;r<e.length;r++)t+=0==r?"<option value='"+e[r]+"' selected='selected'>"+e[r]+"</option>":"<option value='"+e[r]+"' >"+e[r]+"</option>";document.getElementById("provider").innerHTML=t,e.length>0?(document.getElementById("meter").setAttribute("min",1),document.getElementById("meter").setAttribute("value",1)):(document.getElementById("meter").setAttribute("value",0),document.getElementById("meter").setAttribute("min",0)),document.getElementById("meter").setAttribute("max",e.length),fetchProvider()})).catch((e=>{fplReady=setTimeout(fetchProviderList,retryMs)}))}try{fetchProviderList()}catch(e){fplReady=setTimeout(fetchProviderList,retryMs)}