var map,polePath,lineSymbol;let fmrReady=null,ftgReady=null,flsReady=null,fppReady=null,retryMs=5e3,siteId=null,point=null,mapVendor=null,siteX=0,siteY=0,marker=null,endMarker=null,mapCenter={lat:0,lng:0},mapRenderUrl=null,urlOnOffNetSuffix="";function fetchListSites(){null!=flsReady&&clearTimeout(flsReady);let e=document.getElementById("country"),t=e.options[e.selectedIndex].value;urlOnOffNetSuffix=document.getElementById("onNet").checked?"onnet?country="+t:"offnet?country="+t,fetch(localStorage.getItem("mni.gatewayUrl")+"/site/"+urlOnOffNetSuffix,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();flsReady=setTimeout(fetchListSites,retryMs)})).then((e=>{let t="<option disabled value='-1' selected='selected'> -- select a site -- </option>";for(var n=0;n<e.length;n++)t+="<option value='"+e[n].siteId+"' >"+e[n].reference+"</option>";document.getElementById("siteId").innerHTML=t,document.getElementById("siteArea").setAttribute("value",""),document.getElementById("siteType").setAttribute("value","")})).catch((e=>{flsReady=setTimeout(fetchListSites,retryMs)}))}function fetchMapRender(){null!=fmrReady&&clearTimeout(fmrReady),fetch(localStorage.getItem("mni.gatewayUrl")+"/ui/mapRender",{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();fmrReady=setTimeout(fetchMapRender,retryMs)})).then((e=>{null!=e.vendor&&(document.getElementById("mapVendor").innerHTML="<option value='"+e.vendor+"' selected='selected'>"+e.vendor+"</option>"),null!=e.url&&(mapRenderUrl=e.url+"&loading=async&callback=displayMap&v=weekly")})).catch((e=>{fmrReady=setTimeout(fetchMapRender,retryMs)}))}function fetchSite(){null!=ftgReady&&clearTimeout(ftgReady);let e=document.getElementById("siteId");siteId=e.options[e.selectedIndex].value,poleCoordinates=[],mapCenter={lat:0,lng:0},"-1"!=siteId&&"-1"!=point&&(fetch(localStorage.getItem("mni.gatewayUrl")+"/site/"+siteId,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json();ftgReady=setTimeout(fetchSite,retryMs)})).then((e=>{null!=e&&(siteX=e.location.coordinate.x,siteY=e.location.coordinate.y,void 0!==document.getElementById("mapRender")&&null!=document.getElementById("mapRender")&&(map.setCenter({lat:siteX,lng:siteY}),null!=marker&&marker.setMap(null),marker.setPosition({lat:siteX,lng:siteY}),marker.setMap(map)),null!=e.area&&document.getElementById("siteArea").setAttribute("value",e.area),null!=e.type&&document.getElementById("siteType").setAttribute("value",e.type))})).catch((e=>{ftgReady=setTimeout(fetchSite,retryMs)})),loadScript(mapRenderUrl,(function(){window.displayMap=function(){map=new google.maps.Map(document.getElementById("map"),{zoom:17,center:{lat:siteX,lng:siteY},mapTypeId:"hybrid",disableDefaultUI:!0}),marker=new google.maps.Marker({position:{lat:siteX,lng:siteY},label:{text:"îŸ®",fontFamily:"Material Symbols Outlined",color:"#ffffff",fontSize:"18px"},map})}})))}try{countryListPopulate(),fetchMapRender()}catch(e){fmrReady=setTimeout(fetchMapRender,retryMs)}try{fetchListSites()}catch(e){flsReady=setTimeout(fetchListSites,retryMs)}