let rackId=null,point=null;function fetchListRack(){let e=document.getElementById("country"),t=e.options[e.selectedIndex].value;fetch(localStorage.getItem("ni.gatewayUrl")+"/rack?country="+t,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json()})).then((e=>{let t=window.location.pathname.replace(localStorage.getItem("ni.rootUrl")+"/rack/",""),s="<option disabled value='-1' selected='selected'> -- select a rack -- </option>";null!=t&&(s="<option disabled value='-1'> -- select a rack -- </option>");for(var o=0;o<e.length;o++)t==e[o]?s+="<option value='"+e[o]+"' selected='selected'>"+e[o]+"</option>":s+="<option value='"+e[o]+"' >"+e[o]+"</option>";document.getElementById("rackId").innerHTML=s,null!=t&&fetchRackPoints()})).catch((e=>{console.error(e)}))}function fetchRack(){let e=document.getElementById("rackId");rackId=e.options[e.selectedIndex].value;let t=document.getElementById("rackPoint");point=t.options[t.selectedIndex].value;let s=document.getElementById("country"),o=s.options[s.selectedIndex].value,r=document.querySelector(".grid");for(;r.firstChild;)r.removeChild(r.firstChild);fetch(localStorage.getItem("ni.gatewayUrl")+"/rack/"+rackId+"?point="+point,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json()})).then((e=>{let t=e.slots,s=0,a=0,l=0,i=0,n=e.slotUsage.reverse(),c="historical";null!=e.source&&(c=e.source),r.style.setProperty("--max-rack-slots",t);for(let e=0;e<n.length;e++){let o=document.createElement("div");switch(o.setAttribute("id","slot"+(t-e)),n[e].usage){case"free":o.setAttribute("title",t-e+": "+n[e].usage),"predicted"==c?o.setAttribute("class","predictedSlotFree"):o.setAttribute("class","slotFree"),a+=1;break;case"used":o.setAttribute("title",t-e+": "+n[e].usage+" "+n[e].host),"predicted"==c?o.setAttribute("class","predictedSlotUsed"):o.setAttribute("class","slotUsed"),s+=1;break;case"reserved":o.setAttribute("title",t-e+": "+n[e].usage),"predicted"==c?o.setAttribute("class","predictedSlotReserved"):o.setAttribute("class","slotReserved"),l+=1;break;case"faulty":o.setAttribute("title",t-e+": "+n[e].usage),"predicted"==c?o.setAttribute("class","predictedSlotFaulty"):o.setAttribute("class","slotFaulty"),i+=1}o.classList.add("cell"),r.appendChild(o);let d="";if("used"===n[e].usage)if(null!=n[e].neId){let s=document.getElementById("country"),o=s.options[s.selectedIndex].value;d="&emsp;"+(t-e)+' <a href="'+localStorage.getItem("ni.rootUrl")+"/ne/"+n[e].neId+"?country="+o+'" target="_self">'+n[e].host+"</a>&emsp;"}else d="&emsp;"+(t-e);else d="&emsp;"+(t-e);document.getElementById("slot"+(t-e)).innerHTML=d}null==e?.decommissioned&&(e.decommissioned="");let d="<b>Reference</b>:&emsp;"+e.reference+"<br><center>( "+rackId+" )</center><br><br>Commissioned:&emsp;&emsp;"+e.commissioned+"<br>Decommissioned:&emsp;"+e.decommissioned+"<br>Source:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;"+c+"<br><br><b>Dimensions</b>:<br>H/W/D:&emsp;"+e.dimensions.height+" / "+e.dimensions.width+" / "+e.dimensions.depth+" "+e.dimensions.unit+"<br>Slots:&emsp;&emsp;"+e.slots+'<br><br><b>Location</b>:<br>Site:&emsp;<a href="'+localStorage.getItem("ni.rootUrl")+"/site/"+e.siteId+"?country="+o+'" target="_self">'+e.siteId+"</a><br>X,Y,Z:&emsp;&emsp;"+e.coordinate.x+" , "+e.coordinate.y+" , "+e.coordinate.z+"<br>Area:&emsp;&emsp;"+e.area+"<br>Floor:&emsp;&emsp;"+e.floor+"<br>Row:&emsp;&emsp;"+e.row+'<br><br><b>Usage Summary:</b><br><div class="stateusage-key"><div id="stateusage-faulty" class="stateusage">Faulty: '+i+'</div><div id="stateusage-reserved" class="stateusage">Reserved: '+l+'</div><div id="stateusage-used" class="stateusage">Used: '+s+'</div><div id="stateusage-free" class="stateusage">Free: '+a+"</div></div>";document.getElementById("metadataPanel").innerHTML=d})).catch((e=>{console.error(e)}))}function fetchRackPoints(){let e=document.getElementById("rackId");rackId=e.options[e.selectedIndex].value,"-1"!=rackId&&fetch(localStorage.getItem("ni.gatewayUrl")+"/rack/timeline/"+rackId,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json()})).then((e=>{let t="<option disabled value='-1'> -- select a date/time -- </option>";for(var s=0;s<e.length;s++)t+=0==s?"<option selected='selected' value='"+e[s].point+"' >"+e[s].point+"</option>":"<option value='"+e[s].point+"' >"+e[s].point+"</option>";document.getElementById("rackPoint").innerHTML=t,fetchRack()})).catch((e=>{console.error(e)}))}try{countryListPopulate(fetchListRack)}catch(e){console.error(e)}