let retryMs=1e3,refreshMs=3e5,fpReady=null,dpReady=null,spReady=null,fplReady=null;function firstProvider(){let e=document.getElementById("provider");e.selectedIndex,e.length>1&&(e.selectedIndex=1,fetchProvider(),document.getElementById("meter").setAttribute("value",1))}function previousProvider(){let e=document.getElementById("provider"),t=e.selectedIndex;e.length,t>=2&&(e.selectedIndex=t-1,fetchProvider(),document.getElementById("meter").setAttribute("value",t-1))}function nextProvider(){let e=document.getElementById("provider"),t=e.selectedIndex;t<e.length-1&&(e.selectedIndex=t+1,fetchProvider(),document.getElementById("meter").setAttribute("value",t+1))}function lastProvider(){let e=document.getElementById("provider"),t=e.selectedIndex,n=e.length-1;t<n&&n>1&&(e.selectedIndex=n,fetchProvider(),document.getElementById("meter").setAttribute("value",n))}function deleteProvider(){let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;null!=t&&"-1"!=t&&fetch(localStorage.getItem("ni.gatewayUrl")+"/admin/workflow/engine/"+t,{method:"DELETE",keepalive:!0}).then((e=>{e.ok?(previousProvider(),fetchProviderList()):window.alert(`Failed to delete provider ${t}`)})).catch((e=>{console.error(e)}))}function redisplayProvider(){let e=document.getElementById("provider");"-1"==e.options[e.selectedIndex].value?clearProvider():fetchProvider()}function newProvider(){document.getElementById("provider").value="-1",clearProvider()}function saveProvider(){let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;if(document.getElementById("engineName").value.length>0)if(document.getElementById("engineUrl").value.length>0){let e=document.getElementById("engineType"),n=e.options[e.selectedIndex].value;if("-1"!=n)if("-1"==t){let e={name:document.getElementById("engineName").value,engine:{url:document.getElementById("engineUrl").value,username:document.getElementById("engineUsername").value,password:document.getElementById("enginePassword").value,type:n}};fetch(localStorage.getItem("ni.gatewayUrl")+"/admin/workflow/engine",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),keepalive:!0}).then((e=>{e.ok&&(fetchProviderList(),lastProvider())})).catch((e=>{window.alert(e)}))}else{let e={workflowEngineId:t,name:document.getElementById("engineName").value,engine:{url:document.getElementById("engineUrl").value,username:document.getElementById("engineUsername").value,password:document.getElementById("enginePassword").value,type:n}};fetch(localStorage.getItem("ni.gatewayUrl")+"/admin/workflow/engine/"+t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then((e=>{e.ok||window.alert(`Failed to update provider ${t}`)})).catch((e=>{window.alert(e)}))}else window.alert("engine type must be specified")}else window.alert("engine URL must be specified");else window.alert("name must be specified")}function clearProvider(){document.getElementById("engineName").value="",document.getElementById("engineUsername").value="",document.getElementById("enginePassword").value="",document.getElementById("engineUrl").value="",document.getElementById("engineType").value="-1"}function displayProvider(e){clearProvider();let t=document.getElementById("provider");t.options[t.selectedIndex].value,void 0!==e&&null!=e&&(document.getElementById("engineName").value=e.name,document.getElementById("engineUsername").value=e.engine.username,document.getElementById("enginePassword").value=e.engine.password,document.getElementById("engineUrl").value=e.engine.url,document.getElementById("engineType").value=e.engine.type)}function fetchProvider(){null!=fpReady&&clearTimeout(fpReady);let e=document.getElementById("provider"),t=e.options[e.selectedIndex].value;null!=t&&fetch(localStorage.getItem("ni.gatewayUrl")+"/admin/workflow/engine/"+t,{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json()})).then((e=>{displayProvider(e)})).catch((e=>{console.error(e)}))}function fetchProviderList(){null!=fplReady&&clearTimeout(fplReady),fetch(localStorage.getItem("ni.gatewayUrl")+"/admin/workflow/engine",{method:"GET",headers:{Accept:"application/json"},keepalive:!0}).then((e=>{if(e.ok)return e.json()})).then((e=>{let t="<option disabled value='-1' selected='selected'> -- new provider -- </option>";for(var n=0;n<e.length;n++)t+=0==n?"<option value='"+e[n]+"' selected='selected'>"+e[n]+"</option>":"<option value='"+e[n]+"' >"+e[n]+"</option>";document.getElementById("provider").innerHTML=t,e.length>0?(document.getElementById("meter").setAttribute("min",1),document.getElementById("meter").setAttribute("value",1)):(document.getElementById("meter").setAttribute("value",0),document.getElementById("meter").setAttribute("min",0)),document.getElementById("meter").setAttribute("max",e.length),fetchProvider()})).catch((e=>{console.error(e)}))}try{fetchProviderList()}catch(e){console.error(e)}